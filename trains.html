<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrainSafe - Poyezdlar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background: #60d1decb;
            color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .logo {
            height: 50px;
            margin-right: 15px;
            transition: transform 0.3s;
        }
        
        .logo:hover {
            transform: scale(1.1);
        }
        
        .status-badge.normal,
        .normal {
            color: #198754;
        }
        
        .status-badge.warning,
        .warning {
            color: #ffc107;
        }
        
        .status-badge.alarm,
        .alarm {
            color: #dc3545;
        }
        
        .back-btn {
            margin: 15px;
        }
        
        .table-responsive {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .modal-table td {
            vertical-align: middle;
        }
        
        .lang-switcher {
            display: flex;
            gap: 5px;
            background: url('assets/lang-bg.png') no-repeat center/cover;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .lang-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            border-radius: 3px;
            transition: background 0.3s;
        }
        
        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.4);
        }
        
        .lang-btn.active {
            background: rgba(255, 255, 255, 0.6);
            font-weight: bold;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="logo-container">
            <img src="railsafe.png" alt="TrainSafe Logo" class="logo">
            <img src="iconr.png" alt="Partner Logo 1" class="logo">
            <img src="tstu.png" alt="Partner Logo 2" class="logo">
        </div>
        <div class="d-flex align-items-center">
            <div class="lang-switcher">
                <button class="lang-btn active" data-lang="uz">UZB</button>
                <button class="lang-btn" data-lang="ru">RUS</button>
                <button class="lang-btn" data-lang="en">ENG</button>
            </div>
            <a href="profil.html" class="text-white text-decoration-none ms-3"><span class="user-icon">👤</span> <span id="username">IRGASHEV N.N</span></a>
            <a href="note.html" class="text-white ms-4 fs-4 text-decoration-none">🔔</a>
        </div>
    </header>

    <div class="d-flex justify-content-start">
        <button class="btn btn-outline-secondary back-btn" onclick="window.location='stations.html'" id="back-btn">Orqaga</button>
    </div>

    <main class="container mt-3">
        <h2 class="text-center" id="trains-title">Poyezdlar Ro'yxati</h2>
        <div class="card">
            <div class="card-body">
                <h5 class="card-title" id="freight-trains-title">Yuk Tashish Poyezdlari</h5>
                <div class="table-responsive">
                    <table class="table table-hover align-middle" aria-label="Trains List" id="trains-table">
                        <thead class="table-light">
                            <tr>
                                <th scope="col" id="table-col-id">T/r</th>
                                <th scope="col" id="table-col-name">Poyezd Nomi</th>
                                <th scope="col" id="table-col-composition">Harakat Tarkibi</th>
                                <th scope="col" id="table-col-risk">Xavf Ehtimoli</th>
                                <th scope="col" id="table-col-actions">Amallar</th>
                            </tr>
                        </thead>
                        <tbody id="trainsTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <div class="modal fade" id="trainDetailsModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Poyezd Harorat Jadvali</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="modal-close-btn"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered modal-table" aria-label="Train Temperature Table" id="temps-table">
                        <thead>
                            <tr>
                                <th scope="col" id="modal-col-axle">G'ildirak O'qi</th>
                                <th scope="col" id="modal-col-right">O'ng (°C)</th>
                                <th scope="col" id="modal-col-left">Chap (°C)</th>
                            </tr>
                        </thead>
                        <tbody id="tempsTable"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary btn-sm" data-bs-dismiss="modal" id="modal-close">Yopish</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const translations = {
            uz: {
                title: "TrainSafe - Poyezdlar",
                back_btn: "Orqaga",
                trains_title: "Poyezdlar Ro'yxati",
                freight_trains_title: "Yuk Tashish Poyezdlari",
                table_col_id: "T/r",
                table_col_name: "Poyezd Nomi",
                table_col_composition: "Harakat Tarkibi",
                table_col_risk: "Xavf Ehtimoli",
                table_col_actions: "Amallar",
                modal_title: "Poyezd {name} Harorat Jadvali",
                modal_col_axle: "G'ildirak O'qi",
                modal_col_right: "O'ng (°C)",
                modal_col_left: "Chap (°C)",
                modal_close: "Yopish",
                modal_close_aria: "Yopish",
                risk_none: "Yo'q",
                risk_vagon: "Vagon {number}",
                view_btn_aria: "Poyezd {name} haroratini ko'rish",
                table_aria: "Poyezdlar ro'yxati",
                modal_table_aria: "Poyezd harorat jadvali"
            },
            ru: {
                title: "TrainSafe - Поезда",
                back_btn: "Назад",
                trains_title: "Список поездов",
                freight_trains_title: "Грузовые поезда",
                table_col_id: "№",
                table_col_name: "Название поезда",
                table_col_composition: "Состав поезда",
                table_col_risk: "Вероятность риска",
                table_col_actions: "Действия",
                modal_title: "Таблица температур поезда {name}",
                modal_col_axle: "Ось колеса",
                modal_col_right: "Правая (°C)",
                modal_col_left: "Левая (°C)",
                modal_close: "Закрыть",
                modal_close_aria: "Закрыть",
                risk_none: "Нет",
                risk_vagon: "Вагон {number}",
                view_btn_aria: "Просмотреть температуры поезда {name}",
                table_aria: "Список поездов",
                modal_table_aria: "Таблица температур поезда"
            },
            en: {
                title: "TrainSafe - Trains",
                back_btn: "Back",
                trains_title: "List of Trains",
                freight_trains_title: "Freight Trains",
                table_col_id: "ID",
                table_col_name: "Train Name",
                table_col_composition: "Train Composition",
                table_col_risk: "Risk Probability",
                table_col_actions: "Actions",
                modal_title: "Train {name} Temperature Table",
                modal_col_axle: "Wheel Axle",
                modal_col_right: "Right (°C)",
                modal_col_left: "Left (°C)",
                modal_close: "Close",
                modal_close_aria: "Close",
                risk_none: "None",
                risk_vagon: "Car {number}",
                view_btn_aria: "View temperatures for train {name}",
                table_aria: "List of trains",
                modal_table_aria: "Train temperature table"
            }
        };

        let currentLang = localStorage.getItem('language') || 'uz';

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('language', lang);
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
            });
            document.documentElement.lang = lang;
            document.title = translations[lang].title;
            document.getElementById('back-btn').textContent = translations[lang].back_btn;
            document.getElementById('trains-title').textContent = translations[lang].trains_title;
            document.getElementById('freight-trains-title').textContent = translations[lang].freight_trains_title;
            document.getElementById('table-col-id').textContent = translations[lang].table_col_id;
            document.getElementById('table-col-name').textContent = translations[lang].table_col_name;
            document.getElementById('table-col-composition').textContent = translations[lang].table_col_composition;
            document.getElementById('table-col-risk').textContent = translations[lang].table_col_risk;
            document.getElementById('table-col-actions').textContent = translations[lang].table_col_actions;
            document.getElementById('trains-table').setAttribute('aria-label', translations[lang].table_aria);
            document.getElementById('modal-col-axle').textContent = translations[lang].modal_col_axle;
            document.getElementById('modal-col-right').textContent = translations[lang].modal_col_right;
            document.getElementById('modal-col-left').textContent = translations[lang].modal_col_left;
            document.getElementById('temps-table').setAttribute('aria-label', translations[lang].modal_table_aria);
            document.getElementById('modal-close').textContent = translations[lang].modal_close;
            document.getElementById('modal-close-btn').setAttribute('aria-label', translations[lang].modal_close_aria);
            initializeTrainsPage();
        }

        function initializeTrainsPage() {
            const trains = [{
                id: 1,
                name: 'Freight-4925',
                composition: '3+53',
                risk: translations[currentLang].risk_none,
                right_temps: [10, 11, 12, 13],
                left_temps: [11, 10, 12, 13]
            }, {
                id: 2,
                name: 'Freight-3552',
                composition: '1+46',
                risk: translations[currentLang].risk_none,
                right_temps: [9, 10, 11, 12],
                left_temps: [10, 9, 11, 12]
            }, {
                id: 3,
                name: 'Freight-3950',
                composition: '2+50',
                risk: translations[currentLang].risk_vagon.replace('{number}', '15'),
                right_temps: [12, 13, 11, 12],
                left_temps: [11, 12, 10, 13]
            }, {
                id: 4,
                name: 'Freight-4611',
                composition: '1+53',
                risk: translations[currentLang].risk_vagon.replace('{number}', '52'),
                right_temps: [13, 11, 12, 10],
                left_temps: [12, 10, 13, 11]
            }, {
                id: 5,
                name: 'Freight-1797',
                composition: '1+45',
                risk: translations[currentLang].risk_none,
                right_temps: [10, 11, 9, 12],
                left_temps: [11, 10, 9, 13]
            }];

            const trainsTable = document.getElementById('trainsTable');
            trainsTable.innerHTML = '';
            trains.forEach(train => {
                const tr = document.createElement('tr');
                const riskClass = train.risk === translations[currentLang].risk_none ? 'normal' : 'warning';
                tr.innerHTML = `
                    <td>${train.id}</td>
                    <td>${train.name}</td>
                    <td>${train.composition}</td>
                    <td><span class="status-badge ${riskClass}">${train.risk}</span></td>
                    <td><button class="btn btn-primary btn-sm" data-train-id="${train.id}" aria-label="${translations[currentLang].view_btn_aria.replace('{name}', train.name)}">Ko'rish</button></td>
                `;
                trainsTable.appendChild(tr);
            });

            document.querySelectorAll('#trainsTable button').forEach(button => {
                button.addEventListener('click', () => {
                    const trainId = button.getAttribute('data-train-id');
                    const train = trains.find(t => t.id === parseInt(trainId));
                    if (train) showTrainTemps(train);
                });
            });
        }

        function showTrainTemps(train) {
            document.getElementById('modalTitle').textContent = translations[currentLang].modal_title.replace('{name}', train.name);
            const tempsTable = document.getElementById('tempsTable');
            tempsTable.innerHTML = '';
            for (let i = 0; i < 4; i++) {
                const axle = i + 1;
                const right = train.right_temps[i];
                const left = train.left_temps[i];
                tempsTable.innerHTML += `
                    <tr>
                        <td>${axle}</td>
                        <td class="${getTempClass(right)}">${right} °C</td>
                        <td class="${getTempClass(left)}">${left} °C</td>
                    </tr>
                `;
            }
            new bootstrap.Modal(document.getElementById('trainDetailsModal')).show();
        }

        function getTempClass(temp) {
            if (temp < 10) return 'normal';
            if (temp <= 12) return 'warning';
            return 'alarm';
        }

        function initializePage() {
            setLanguage(currentLang);
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => setLanguage(btn.getAttribute('data-lang')));
            });
        }

        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>


</html>
